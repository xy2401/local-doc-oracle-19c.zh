<html lang="en-us"  xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="Use the chactl query diagnosis command to return problems and diagnosis, and suggested corrective actions associated with the problem for specific cluster nodes or Oracle Real Application Clusters (Oracle RAC) databases.">
      <meta name="description" content="Use the chactl query diagnosis command to return problems and diagnosis, and suggested corrective actions associated with the problem for specific cluster nodes or Oracle Real Application Clusters (Oracle RAC) databases.">
      <title>chactl查询诊断</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="User’s Guide">
      <meta property="og:description" content="Use the chactl query diagnosis command to return problems and diagnosis, and suggested corrective actions associated with the problem for specific cluster nodes or Oracle Real Application Clusters (Oracle RAC) databases.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="User’s Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="autonomous-health-framework-users-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-21T23:14:30-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2016, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96320-02">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="chactl-calibrate.html" title="Previous" type="text/html">
      <link rel="next" href="chactl-query-model.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Autonomous Health Framework User’s Guide">
    <meta name="dcterms.isVersionOf" content="ATNMS">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body >
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="chactl-calibrate.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="chactl-query-model.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">用户指导</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="appendixes.html" property="item" typeof="WebPage"><span property="name">附录</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="chactl-command-reference.html" property="item" typeof="WebPage"><span property="name">chactl命令参考</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">chactl查询诊断</li>
            </ol>
            <a id="GUID-07F4C0DB-541B-4509-B851-64E497B0D876" name="GUID-07F4C0DB-541B-4509-B851-64E497B0D876"></a>
            
            <h2 id="ATNMS-GUID-07F4C0DB-541B-4509-B851-64E497B0D876" class="sect2"><span class="enumeration_section">D.6</span> chactl查询诊断</h2>
         </header>
         <div class="ind">
            <div>
               <p>使用<code class="codeph">chactl query diagnosis</code>命令可以返回问题和诊断，并建议与特定群集节点或Oracle Real Application Clusters（Oracle RAC）数据库的问题相关的纠正措施。
               </p>
               <div class="section">
                  <p class="subhead1" id="GUID-07F4C0DB-541B-4509-B851-64E497B0D876__GUID-D5333056-AC6B-4A9D-B194-58A8C0EFB197">句法</p><pre class="pre codeblock"><code>chactl query diagnosis [-cluster|-db <span class="variable" translate="no">db_unique_name</span>] [-start <span class="variable" translate="no">time</span> -end <span class="variable" translate="no">time</span>] [-htmlfile <span class="variable" translate="no">file_name</span>][-help]</code></pre><p>以<code class="codeph">YYYY-MM-DD HH24:MI:SS</code>格式指定日期和时间。
                  </p>
                  <p>在前面的语法中，您必须考虑以下几点：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>如果未提供任何选项，则<code class="codeph">chactl query diagnosis</code>命令将返回所有受监视节点和数据库的当前状态。<code class="codeph">chactl query diagnosis</code>命令通过显示其诊断标识符（例如， <code class="codeph">Storage Bandwidth Saturation</code>报告目标的一般状态，例如<strong class="term">ABNORMAL</strong> 。这是检查数据库或集群中任何<strong class="term">ABNORMAL</strong>状态的快速方法。
                        </p>
                     </li>
                     <li>
                        <p>如果在目标名称后面提供时间选项，则<code class="codeph">chactl query diagnosis</code>命令将指定目标的状态限制为指定时间间隔内的条件。压缩时间序列列出了在时间间隔，开始和结束时间中发生的不同事件的原因的标识符。
                        </p>
                     </li>
                     <li>
                        <p>如果事件和原因在特定时间间隔内重复出现，则问题仅报告一次。开始时间是第一次发生事件的开始时间，结束时间是特定时间间隔内最后一次事件发生的结束时间。</p>
                     </li>
                     <li>
                        <p>如果指定不带数据库名称的<code class="codeph">–db</code>选项，则<code class="codeph">chactl query diagnosis</code>命令将显示所有数据库的诊断信息。但是，如果指定了数据库名称，则<code class="codeph">chactl query diagnosis</code>命令将显示正在监视的所有数据库实例的诊断信息。
                        </p>
                     </li>
                     <li>
                        <p>如果指定不带主机名的<code class="codeph">–cluster</code>选项，则<code class="codeph">chactl query diagnosis</code>命令将显示该群集中所有主机的诊断信息。
                        </p>
                     </li>
                     <li>
                        <p>如果未指定时间间隔，则<code class="codeph">chactl query diagnosis</code>命令仅显示所有或指定目标的当前问题。<code class="codeph">chactl query diagnosis</code>命令不会显式显示频率统计信息。但是，您可以计算过去24小时内目标中发生的正常和异常事件的数量。
                        </p>
                     </li>
                     <li>
                        <p>如果在指定的时间间隔内未发生任何事件，则<code class="codeph">chactl query diagnosis</code>命令将返回文本消息，例如， <samp class="msgph">数据库/主机正在运行NORMALLY</samp> ，或者<samp class="msgph">未发现任何事件</samp> 。
                        </p>
                     </li>
                     <li>
                        <p>如果目标的状态为<strong class="term">NORMAL</strong> ，则命令不报告它。<code class="codeph">chactl query diagnosis</code>命令仅报告指定时间间隔内具有<strong class="term">ABNORMAL</strong>状态的目标。
                        </p>
                     </li>
                  </ul>
                  <p><span class="bold">输出参数：</span></p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>事件开始时间</p>
                     </li>
                     <li>
                        <p>事件结束时间（仅适用于默认数据库和/或主机，非详细输出）</p>
                     </li>
                     <li>
                        <p>目标（例如，数据库，主机）</p>
                     </li>
                     <li>
                        <p>问题</p>
                        <p>说明：问题的详细说明</p>
                        <p>原因：问题的根本原因和影响因素</p>
                     </li>
                     <li>
                        <p>操作：纠正诊断中涵盖的异常状态的操作</p>
                     </li>
                  </ul>
                  <p><span class="bold">报告格式：</span>诊断信息以时间压缩或时间序列顺序显示，按组件分组。
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-07F4C0DB-541B-4509-B851-64E497B0D876__GUID-EF2B376B-F517-4B5A-A38B-0E30F3C91C6F">例子</p>
                  <p>要在特定时间间隔内显示数据库的诊断信息：</p><pre class="pre codeblock"><code>$ chactl query diagnosis -db oltpacdb -start "2016-02-01 02:52:50.0" -end "2016-02-01 03:19:15.0" 
2016-02-01 01:47:10.0  Database oltpacdb  DB Control File IO Performance (oltpacdb_1) [detected]
2016-02-01 01:47:10.0  Database oltpacdb  DB Control File IO Performance (oltpacdb_2) [detected]
2016-02-01 02:52:15.0  Database oltpacdb  DB CPU Utilization (oltpacdb_2) [detected]
2016-02-01 02:52:50.0  Database oltpacdb  DB CPU Utilization (oltpacdb_1) [detected]
2016-02-01 02:59:35.0  Database oltpacdb  DB Log File Switch (oltpacdb_1) [detected]
2016-02-01 02:59:45.0  Database oltpacdb  DB Log File Switch (oltpacdb_2) [detected]

Problem: DB Control File IO Performance
Description: CHA has detected that reads or writes to the control files are slower than expected.
Cause: The Cluster Health Advisor (CHA) detected that reads or writes to the control files were slow 
because of an increase in disk IO. 
The slow control file reads and writes may have an impact on checkpoint and Log Writer (LGWR) performance.
Action: Separate the control files from other database files and move them to faster disks or Solid State Devices.

Problem: DB CPU Utilization
Description: CHA detected larger than expected CPU utilization for this database.
Cause: The Cluster Health Advisor (CHA) detected an increase in database CPU utilization 
because of an increase in the database workload.
Action: Identify the CPU intensive queries by using the Automatic Diagnostic and Defect Manager (ADDM)
and follow the recommendations given there. Limit the number of CPU intensive queries
or relocate sessions to less busymachines. Add CPUs if the CPU capacity is insufficent to support the load 
without a performance degradation or effects on other databases.

Problem: DB Log File Switch
Description: CHA detected that database sessions are waiting longer than expected for log switch completions.
Cause: The Cluster Health Advisor (CHA) detected high contention during log switches 
because the redo log files were small and the redo logs switched frequently.
Action: Increase the size of the redo logs.</code></pre></div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-07F4C0DB-541B-4509-B851-64E497B0D876__ERRORMESSAGE-488129C9">错误信息</p>
                  <p><span class="bold">消息：</span> <samp class="msgph"><span class="variable" translate="no">Target</span>正常运行</samp></p>
                  <p><span class="bold">描述：</span>目标上没有发现任何事件。
                  </p>
                  <p><span class="bold">消息：</span> <code class="codeph">No data was found for active <span class="variable" translate="no">Target</span></code></p>
                  <p><span class="bold">描述：</span>未找到任何数据，但目标在查询时正在运行或处于活动状态。
                  </p>
                  <p><span class="bold">消息：</span> <samp class="msgph">目标未激活或未被监视。</samp></p>
                  <p><span class="bold">描述：</span>未找到任何数据，因为在查询时未监视目标。
                  </p>
               </div>
               <!-- class="section" -->
            </div>
            <div>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="chactl-command-reference.html#GUID-9AD6BC7D-F0F5-41E9-80CB-9BD911FCE586" title="Oracle Cluster Health Advisor命令使Oracle Grid Infrastructure用户能够管理目标上的基本监视功能。">chactl命令参考</a></p>
                  </div>
               </div>
            </div>
            
         </div>
      </article>
   </body>
</html>